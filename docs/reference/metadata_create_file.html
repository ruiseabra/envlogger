<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create a metadata file — metadata_create_file • envlogger</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create a metadata file — metadata_create_file"><meta property="og:description" content="Create an EnvLogger metadata file. These files can be used to provide additional information about the matching data file, as well as to store correction details necessary for the successful import of data using read_env()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">envlogger</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ruiseabra/envlogger/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a metadata file</h1>
    <small class="dont-index">Source: <a href="https://github.com/ruiseabra/envlogger/blob/HEAD/R/metadata.R" class="external-link"><code>R/metadata.R</code></a></small>
    <div class="hidden name"><code>metadata_create_file.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create an <code>EnvLogger</code> metadata file. These files can be used to provide additional information about the matching data file, as well as to store correction details necessary for the successful import of data using <code><a href="read_env.html">read_env()</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">metadata_create_file</span><span class="op">(</span><span class="va">path</span>, new_vals <span class="op">=</span> <span class="cn">NULL</span>, update <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>The path to a single data report file (additional details below).</p></dd>


<dt id="arg-new-vals">new_vals<a class="anchor" aria-label="anchor" href="#arg-new-vals"></a></dt>
<dd><p>A list with values to be added to the metadata file about to be created. If not supplied, a default template file with all fields set to <code>NA</code> is generated. Elements in <code>new_vals</code> must have the exact same name of the field they correspond to, and the values provided must be single element vectors convertible to character. Elements with names not present in the <code>field</code> column of the template metadata file are silently disregarded (additional details below).</p></dd>


<dt id="arg-update">update<a class="anchor" aria-label="anchor" href="#arg-update"></a></dt>
<dd><p>If a metadata file is already present, should the execution stop with an error or should the file be updated with the new values (new values take precedence over the values in the original file, but values in the previous file for fields not covered in the current <code>new_vals</code> are left unchanged).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The path of the metadata file that has been created. In addition, an EnvLogger metadata file is created. The file path to the new file is generated by appending <code>_meta.csv</code> to the end of the <code>path</code> provided. The file created is a <code>CSV</code> file with four columns:</p><ul><li><p><code>field</code> - the name of the metadata field</p></li>
<li><p><code>new_val</code> - the new value to be assigned</p></li>
<li><p><code>type</code> - the format to which <code>new_val</code> will be converted</p></li>
<li><p><code>info</code> - details about the meaning and constraints of each <code>field</code></p></li>
</ul></div>
    <div id="why-use-metadata-files">
    <h2>Why use metadata files</h2>


<p>Large databases of environmental data often include files with errors, inconsistencies and formatting issues. While users can correct such files manually and definitively, such an approach removes the ability to traceback the changes made, sometimes making it impossible to revert those changes later on. This can be a source of many headaches, especially when data has been collected by multiple individuals, using different devices and from distinct locations - and it only gets tougher the larger the data collection network. One should never underestimate the likelihood of new information coming to light years later that implies a reorganization of the database, in which case reverting some of the changes made earlier may be necessary. A way to mitigate this effect is to store corrections in a different file. In this approach, the original file remains intact, and it is the job of the matching metadata file to store the changes and corrections that need to be applied in order for the original data to make perfect sense within the database. Inspecting the metadata file is quick and changes introduced are explicit, traceable and easily revertible. Furthermore, since the metadata file only contains essential fields, the disk space metadata files take up is negligible. That is why the <a href="envlogger-package.html">envlogger-package</a> provides tools to create and read metadata files, and why our team advocates for the use of such files instead of implementing changes/corrections permanently into the original files.</p>
    </div>
    <div id="corrections-to-envlogger-files">
    <h2>Corrections to EnvLogger files</h2>


<p>While EnvLogger report files should have no formatting issues, the data they contain may still require corrections. In this case, there are two use scenarios. In the first, the user is aware of a specific issue and wants to pro-actively address it. To do that, the user can generate a template metadata file (if the <code>new_vals</code> argument isn't provided, all fields are set to <code>NA</code>) and then manually edit the relevant fields. As long as the metadata file is kept in the same folder in which the associated file is stored, the changes it encodes will be reflected when <code><a href="read_env.html">read_env()</a></code> is used to import the data. The second situation corresponds to when <code><a href="read_env.html">read_env()</a></code> itself identifies certain 'standard' issues for which it can provide a correction. In that case, if the user allows, <code><a href="read_env.html">read_env()</a></code> can automatically generate metadata files that will already include the correction parameters necessary. For example, if <code><a href="read_env.html">read_env()</a></code> detects that a file includes timestamps obviously wrong (such as '1970-01-01 00:00'), it will generate a metadata file where the field <code>purge_time_bef</code> is set to '2000-01-01 00:00'. This way, the next time <code><a href="read_env.html">read_env()</a></code> is executed, all entries in the offending file with a timestamp before '2000-01-01 00:00' will be discarded, and data import can resume without issue. Note that an argument could be made that the correction could just be silently applied without the need to generate a metadata file, making the process simpler and reducing clutter. However, such an approach would leave the user blindsided, unaware of changes that may introduce biases in the dataset. Since environmental datasets are often used for high-stakes research, conservation and management, such a level of ambiguity is unacceptable, and therefore the more explicit and traceable approach is used instead.</p>
    </div>
    <div id="data-files-not-conforming-to-the-envlogger-ecosystem">
    <h2>Data files not conforming to the EnvLogger ecosystem</h2>


<p>The <a href="envlogger-package.html">envlogger-package</a> package is built around the EnvLogger ecosystem - devices, smartphone apps and the files they generate. However, our team is aware that many users have data generated using other devices that they want to easily integrate into their environmental datasets. While not all data formats can be accommodated, some flexibility can be gained through the use of metadata files. In this case, these files are used to pass on to <code><a href="read_env.html">read_env()</a></code> certain basic bits of information essential for their correct reading, namely how many lines of header to skip, the format used to store time and a few other parameters. To this effect, there is no automation provided, and the user must generate one metadata file at a time for each of the non-conforming files and manually edit the relevant fields. While this can be laborious, it only needs to be done once for each file. Afterwards, the files are read normally as if the were standard EnvLogger files.</p>
    </div>
    <div id="supported-files">
    <h2>Supported files</h2>


<ul><li><p>EnvLogger data report files with data (not just the header)</p></li>
<li><p>EnvLogger log files</p></li>
<li><p>EnvLogger metadata files (created with <code>metadata_create_file()</code>)</p></li>
<li><p>Other data report files originating from devices other than EnvLoggers, as long as they are accompanied by an EnvLogger metadata file with values set for fields required for their correct interpretation</p></li>
</ul></div>
    <div id="non-envlogger-data-report-files">
    <h2>Non-EnvLogger data report files</h2>


<p>To ensure a high likelihood of success reading data generated outside of the EnvLogger ecosystem using <code><a href="read_env.html">read_env()</a></code>, not only must each non-Envlogger data report file be accompanied by a metadata file created with <code>metadata_create_file()</code>, they must also obey certain simple structure rules, namely:</p><ul><li><p>be a text file, typically <code>CSV</code> or <code>TXT</code></p></li>
<li><p>if present, any contextual information must all be at the head of the file</p></li>
<li><p>data must be stored by rows</p></li>
<li><p>the data section may include column names, but that isn't mandatory</p></li>
<li><p>each row of data must be in the form <code>date_time, temperature</code></p></li>
<li><p>each row of data must include only two columns</p></li>
<li><p>temperature must be represented only as a number (not including the unit)</p></li>
<li><p>the last line of the file is the last row of data
Then, certain information must be provided via the metadata files, namely:</p></li>
<li><p>skip = number of lines to skip to get to the first row of actual data (not the column names, if present; can be zero or any number of lines)</p></li>
<li><p>time_format = the format of date and time (not needed if date_time is in the standard format <code>2025-01-01 10:30:00</code>, corresponding to "%Y-%m-%d %H:%M:%S; check <code><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strptime()</a></code> for more details about time formats)</p></li>
<li><p>sep_dec_comma = set to <code>TRUE</code> if the temperature decimal separator is a comma (not needed if the decimal separator is the standard dot <code>"."</code>)</p></li>
<li><p>additional fields such as <code>id</code>, <code>serial</code>, <code>tdiff</code> and others may be needed to ensure that all features available in <code><a href="read_env.html">read_env()</a></code> are leveraged, but importing can proceed without them</p></li>
</ul></div>
    <div id="issues-unsupported-files">
    <h2>Issues - Unsupported files</h2>


<ul><li><p>Any file not listed in the section <strong>Supported files</strong>.</p></li>
<li><p>These files can be left in place without interfering with data import.</p></li>
<li><p>If you want to silence this warning, either remove affected files from your database or add their paths to the <code>avoid_pattern</code> arg when calling <code><a href="read_env.html">read_env()</a></code> (such paths are available after a call to <code><a href="read_env.html">read_env()</a></code> using <code>$files_with_issues</code>).</p></li>
</ul></div>
    <div id="issues-quality-issues">
    <h2>Issues - Quality issues</h2>


<ul><li><p>Data report files that have not passed the quality checks.</p></li>
<li><p>Issues flagged include the presence of temperature values outside the limits provided, timestamps outside the limits provided, <code>NA</code>s on data or timestamps, or timestamps not unidirectional, constant and without gaps.</p></li>
<li><p>Files that do not pass quality checks are not included in the output.</p></li>
<li><p>Therefore, action is needed to ensure that the affected files are imported.</p></li>
<li><p>To fix this, either manually edit the files addressing the issues identified or (preferably) generate a metadata file with <code>metadata_create_file()</code> for each affected file and edit that metadata file to include the necessary information to resolve the issues. Afterwards, call <code><a href="read_env.html">read_env()</a></code> again to implement the fixes.</p></li>
<li><p>Alternatively, set the <code>auto_generate_fixes</code> and <code>auto_implement_fixes</code> args in <code><a href="read_env.html">read_env()</a></code> to <code>TRUE</code>, as this will allow for the automatic creation of metadata files addressing the issues identified and the immediate implementation of those fixes.</p></li>
</ul></div>
    <div id="issues-full-overlaps">
    <h2>Issues - Full overlaps</h2>


<ul><li><p>Files that fully overlap other files are redundant.</p></li>
<li><p>Affected files can be left in place without interfering with data import.</p></li>
<li><p>However, if you want to silence this warning, either remove affected files from your database or add their paths to the <code>avoid_pattern</code> arg when calling <code><a href="read_env.html">read_env()</a></code>.</p></li>
</ul></div>
    <div id="issues-partial-overlaps-serials">
    <h2>Issues - Partial overlaps SERIALs</h2>


<ul><li><p>Files listed overlap other files for the same serial by more than the stipulated <code>overlap_max_mins</code> arg provided in the call to <code><a href="read_env.html">read_env()</a></code>.</p></li>
<li><p>Affected files are still joined by serial - all data in older files is kept, while overlapping data in newer files is discarded.</p></li>
<li><p>These overlaps are often benign, but consider double checking.</p></li>
<li><p>To address this, either review the affected files and manually correct the overlapping issues permanently or generate a metadata file with <code>metadata_create_file()</code> and adjust <code>purge_time_bef</code>.</p></li>
</ul></div>
    <div id="issues-partial-overlaps-ids">
    <h2>Issues - Partial overlaps IDs</h2>


<ul><li><p>The typical origin of this issue is linked to a change in the logger device used at a monitoring site.</p></li>
<li><p>Affected data is still joined by id - all data in older serial is kept, while overlapping data in newer serial is discarded.</p></li>
<li><p>These overlaps are often benign, but consider double checking.</p></li>
<li><p>To address this, either review the affected files and manually correct the overlapping issues permanently or generate a metadata file with <code>metadata_create_file()</code> and adjust <code>purge_time_bef</code>.</p></li>
<li><p>ATTENTION! In certain situations, set a value for <code>purge_time_aft</code> instead.</p></li>
</ul></div>
    <div id="real-deployment-date">
    <h2>Real deployment date</h2>


<p>It is common practice among certain users to start a logger's mission before actually heading to the field and installing the logger. Depending how this is done, such practice can result in data being collected before it is actually meaningful. In other circumstances, if a logger has been deployed in a non-permanent way, the user may have recovered the logger, brought it back to the lab and only then downloaded the data. In this second situation, the logger's memory will include readings collected after the real deployment that are also not meaningful for any analysis.
To exclude such excess data, crate a metadata file and set the following parameters :</p><ul><li><p>set <code>purge_time_bef</code> to the date when the affected logger was actually installed; any data before this date will be discarded by <code><a href="read_env.html">read_env()</a></code></p></li>
<li><p>set <code>purge_time_aft</code> to the date when the affected logger was actually recovered; any data after this date will be discarded by <code><a href="read_env.html">read_env()</a></code></p></li>
</ul></div>
    <div id="timezone-issues">
    <h2>Timezone issues</h2>


<p>Potential situations:</p><ul><li><p>The smartphone used to program the loggers was set to the wrong timezone</p></li>
<li><p>The smartphone used to retrieve the data was set to the wrong timezone</p></li>
</ul><p>Consequences:</p><ul><li><p>Data timestamps may be shifted from UTC</p></li>
<li><p>Time diff may include timezone diff</p></li>
</ul><p>Edit fields:</p><ul><li><p><code>offset_time</code> = shift timestamps by <code>x</code> seconds (pos or neg)</p></li>
<li><p><code>offset_diff</code> = shift time diff by <code>x</code> seconds (pos or neg)</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="read_env.html">read_env()</a></code>, <code><a href="env_ls.html">env_ls()</a></code>, <code><a href="env_example.html">env_example()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="env_example.html">env_example</a></span><span class="op">(</span><span class="st">"2024-01-12/ptzzymh02a-04CB_CC00_1507_0C-20240112_083030.csv"</span><span class="op">)</span><span class="op">$</span><span class="va">report</span></span></span>
<span class="r-in"><span><span class="va">path_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">path</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span> <span class="op">-</span> <span class="fl">4</span><span class="op">)</span>, <span class="st">"_meta.csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># creating an empty template metadata file</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">path_meta</span><span class="op">)</span> <span class="co"># metadata file doesn't exist yet</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span><span class="va">void</span> <span class="op">&lt;-</span> <span class="fu">metadata_create_file</span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">path_meta</span><span class="op">)</span> <span class="co"># metadata has been created</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">path_meta</span>, skip <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="co"># all fields are set to NA; the user can adjust any necessary values</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             field new_val type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              id      NA  chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          serial      NA  chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            type      NA  chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           v_log      NA  dbl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           v_app      NA  dbl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           tdiff      NA  int</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7             dev      NA  chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          dev_nm      NA  chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          dev_os      NA  chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10           skip      NA  int</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    time_format      NA  chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  sep_dec_comma      NA  lgl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    offset_time      NA  int</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    offset_diff      NA  int</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 purge_temp_min      NA  dbl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 purge_temp_max      NA  dbl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 purge_time_bef      NA dttm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 purge_time_aft      NA dttm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 split_time_gap      NA  lgl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                          info</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                  max 10 chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                device serial number (typically hexadecimal)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                         logging device type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                                      logging device version</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                                   download software version</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                     logger RTC drift in seconds (obs - ref)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7                 brand and model of device used for download</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                              id of device used for download</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9                              OS of device used for download</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10              skip x lines to get to the first line of data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 if not standard provide time format (e.g. %m-%d%-%Y %H:%M)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12                          is the decimal separator a comma?</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13                 shift timestamps by x seconds (pos or neg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14                      shift tdiff by x seconds (pos or neg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15              discard data below x temperature (pos or neg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16              discard data above x temperature (pos or neg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17        discard data before x; format = 1970-01-01 00:00:00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         discard data after x; format = 1970-01-01 00:00:00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19                                split data when gaps found?</span>
<span class="r-in"><span><span class="va">void</span> <span class="op">&lt;-</span> <span class="fu"><a href="env_example.html">env_example</a></span><span class="op">(</span>delete_new_metadata_files <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># delete the new file</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># passing on values during the call to 'metadata_create_file()'</span></span></span>
<span class="r-in"><span><span class="va">new_vals</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   id <span class="op">=</span> <span class="st">"test"</span>,</span></span>
<span class="r-in"><span>   tdiff <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>   purge_temp_min <span class="op">=</span> <span class="op">-</span><span class="fl">60</span>,</span></span>
<span class="r-in"><span>   split_time_gap <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   bad_field <span class="op">=</span> <span class="st">"THIS WILL NOT SHOW UP IN THE FILE GENERATED"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">void</span> <span class="op">&lt;-</span> <span class="fu">metadata_create_file</span><span class="op">(</span><span class="va">path</span>, <span class="va">new_vals</span>, update <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">path_meta</span>, skip <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_meta</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df_meta</span><span class="op">$</span><span class="va">new_val</span><span class="op">)</span>,<span class="op">]</span> <span class="co"># metadata file now includes non-NA values</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             field new_val type                                          info</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              id    test  chr                                    max 10 chr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           tdiff      10  int       logger RTC drift in seconds (obs - ref)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 purge_temp_min     -60  dbl discard data below x temperature (pos or neg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 split_time_gap    TRUE  lgl                   split data when gaps found?</span>
<span class="r-in"><span><span class="co"># note that the field 'bad_field' isn't present</span></span></span>
<span class="r-in"><span><span class="va">void</span> <span class="op">&lt;-</span> <span class="fu"><a href="env_example.html">env_example</a></span><span class="op">(</span>delete_new_metadata_files <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># delete the new file</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rui Seabra, Fernando Lima.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

